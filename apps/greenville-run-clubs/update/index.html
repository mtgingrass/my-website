<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Update Run Club Info - Greenville Run Clubs</title>
    
    <!-- EmailJS SDK -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f7;
            min-height: 100vh;
        }
        
        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-top: 20px;
        }
        
        .header h1 {
            font-size: 32px;
            font-weight: 700;
            color: #1d1d1f;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 18px;
            color: #6e6e73;
        }
        
        .form-card {
            background: white;
            border-radius: 18px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07);
            padding: 32px;
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 24px;
        }
        
        label {
            display: block;
            font-size: 16px;
            font-weight: 600;
            color: #1d1d1f;
            margin-bottom: 8px;
        }
        
        .required {
            color: #ff3b30;
        }
        
        input[type="text"],
        input[type="email"],
        input[type="number"],
        select,
        textarea {
            width: 100%;
            padding: 12px 16px;
            font-size: 16px;
            border: 1px solid #d2d2d7;
            border-radius: 10px;
            background-color: #f5f5f7;
            transition: all 0.2s ease;
            -webkit-appearance: none;
        }
        
        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: #0071e3;
            background-color: white;
            box-shadow: 0 0 0 4px rgba(0, 113, 227, 0.1);
        }
        
        textarea {
            min-height: 120px;
            resize: vertical;
            font-family: inherit;
        }
        
        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 8px;
        }
        
        .checkbox-label {
            display: flex;
            align-items: center;
            font-size: 16px;
            color: #1d1d1f;
            cursor: pointer;
        }
        
        .checkbox-label input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-right: 10px;
            cursor: pointer;
        }
        
        .form-hint {
            font-size: 14px;
            color: #6e6e73;
            margin-top: 6px;
        }
        
        .btn-submit {
            width: 100%;
            padding: 14px 28px;
            font-size: 17px;
            font-weight: 600;
            color: white;
            background-color: #0071e3;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-top: 32px;
        }
        
        .btn-submit:hover {
            background-color: #0077ed;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 113, 227, 0.3);
        }
        
        .btn-submit:active {
            transform: translateY(0);
        }
        
        .btn-submit:disabled {
            background-color: #d2d2d7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .alert {
            padding: 16px 20px;
            border-radius: 10px;
            margin-bottom: 24px;
            font-size: 16px;
            display: none;
        }
        
        .alert-success {
            background-color: #d1f4d1;
            color: #1d5c1d;
            border: 1px solid #a8e6a8;
        }
        
        .alert-error {
            background-color: #ffd9d9;
            color: #8b0000;
            border: 1px solid #ffb3b3;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #0071e3;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 10px;
            vertical-align: middle;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .honey {
            position: absolute;
            left: -9999px;
            top: -9999px;
            height: 0;
            width: 0;
            overflow: hidden;
        }
        
        .back-link {
            display: inline-flex;
            align-items: center;
            color: #0071e3;
            text-decoration: none;
            font-size: 16px;
            margin-top: 20px;
        }
        
        .back-link:hover {
            text-decoration: underline;
        }
        
        .back-link svg {
            margin-right: 6px;
        }

        @media (max-width: 640px) {
            .container {
                padding: 16px;
            }
            
            .form-card {
                padding: 24px;
            }
            
            .header h1 {
                font-size: 28px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèÉ‚Äç‚ôÄÔ∏è Update Run Club Info</h1>
            <p>Help keep Greenville's running community informed</p>
        </div>

        <div id="successAlert" class="alert alert-success">
            <strong>‚úÖ Success!</strong> Your update has been submitted. We'll review it and update the app soon.
        </div>

        <div id="errorAlert" class="alert alert-error">
            <strong>‚ùå Error:</strong> <span id="errorMessage">Something went wrong. Please try again.</span>
        </div>

        <form id="updateForm" class="form-card">
            <!-- Honeypot field for spam protection -->
            <div class="honey" aria-hidden="true">
                <label for="website">Website</label>
                <input type="text" id="website" name="website" tabindex="-1" autocomplete="off">
            </div>

            <div class="form-group">
                <label for="updateType">
                    What would you like to do? <span class="required">*</span>
                </label>
                <select id="updateType" name="updateType" required>
                    <option value="">Choose an option...</option>
                    <option value="update">Update existing club information</option>
                    <option value="new">Add a new run club</option>
                    <option value="remove">Report a club that's no longer active</option>
                </select>
            </div>

            <!-- Section for existing club updates -->
            <div id="existingClubSection" style="display: none;">
                <div class="form-group">
                    <label for="existingClub">
                        Which club? <span class="required">*</span>
                    </label>
                    <select id="existingClub" name="existingClub">
                        <option value="">Select a club...</option>
                        <option value="Greenville Run Club">Greenville Run Club</option>
                        <option value="Running for Brews Greenville">Running for Brews Greenville</option>
                        <option value="Trailside Trotters">Trailside Trotters</option>
                        <option value="Greenville Track Club">Greenville Track Club</option>
                        <option value="Fleet Feet Run Club">Fleet Feet Run Club</option>
                        <option value="Upstate Running Club">Upstate Running Club</option>
                        <option value="Black Girls RUN! Greenville">Black Girls RUN! Greenville</option>
                        <option value="F3 Greenville">F3 Greenville</option>
                        <option value="FiA Greenville">FiA Greenville</option>
                        <option value="Other">Other (please specify in details)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>What needs updating?</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" name="updateItems" value="Meeting time or day">
                            Meeting time or day
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="updateItems" value="Location or address">
                            Location or address
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="updateItems" value="Contact information">
                            Contact information (website, social media, phone)
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="updateItems" value="Club details">
                            Club details or description
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="updateItems" value="Other">
                            Other
                        </label>
                    </div>
                </div>
            </div>

            <!-- Section for new clubs -->
            <div id="newClubSection" style="display: none;">
                <div class="form-group">
                    <label for="newClubName">
                        Club Name <span class="required">*</span>
                    </label>
                    <input type="text" id="newClubName" name="newClubName" placeholder="e.g., Awesome Runners Club">
                </div>

                <div class="form-group">
                    <label for="meetingDetails">
                        Meeting Time & Day <span class="required">*</span>
                    </label>
                    <input type="text" id="meetingDetails" name="meetingDetails" placeholder="e.g., Mondays at 6:30 PM">
                </div>

                <div class="form-group">
                    <label for="location">
                        Meeting Location <span class="required">*</span>
                    </label>
                    <input type="text" id="location" name="location" placeholder="e.g., Unity Park Pavilion, 400 Unity Park Dr">
                </div>
            </div>

            <!-- Common fields -->
            <div id="commonFields" style="display: none;">
                <div class="form-group">
                    <label for="details">
                        Details <span class="required">*</span>
                    </label>
                    <textarea id="details" name="details" placeholder="Please provide all relevant information about this update..." required></textarea>
                    <p class="form-hint">Include specific changes, websites, Instagram handles, or any other helpful information</p>
                </div>

                <div class="form-group">
                    <label for="source">
                        How do you know this information? <span class="required">*</span>
                    </label>
                    <input type="text" id="source" name="source" placeholder="e.g., I'm a member, saw on their Instagram, etc." required>
                </div>

                <div class="form-group">
                    <label for="email">
                        Your Email (optional)
                    </label>
                    <input type="email" id="email" name="email" placeholder="your@email.com">
                    <p class="form-hint">We'll only use this if we need clarification</p>
                </div>

                <div class="form-group">
                    <label for="mathChallenge">
                        What is 3 + 5? <span class="required">*</span>
                    </label>
                    <input type="number" id="mathChallenge" name="mathChallenge" required>
                    <p class="form-hint">This helps us prevent spam</p>
                </div>

                <button type="submit" class="btn-submit" id="submitBtn">
                    Submit Update
                </button>
            </div>
        </form>

        <a href="https://apps.apple.com/app/greenville-run-clubs/id6502799893" class="back-link">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                <path d="M12.5 5L7.5 10L12.5 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
            </svg>
            Back to the app
        </a>
    </div>

    <script>
        // Initialize EmailJS with your Public Key
        // REPLACE 'YOUR_PUBLIC_KEY' with your actual EmailJS public key
        (function() {
            emailjs.init('YOUR_PUBLIC_KEY');
        })();

        // Form elements
        const form = document.getElementById('updateForm');
        const updateType = document.getElementById('updateType');
        const existingSection = document.getElementById('existingClubSection');
        const newSection = document.getElementById('newClubSection');
        const commonFields = document.getElementById('commonFields');
        const submitBtn = document.getElementById('submitBtn');
        const successAlert = document.getElementById('successAlert');
        const errorAlert = document.getElementById('errorAlert');
        const errorMessage = document.getElementById('errorMessage');

        // Show/hide form sections based on update type
        updateType.addEventListener('change', function() {
            const value = this.value;
            
            if (value === 'update' || value === 'remove') {
                existingSection.style.display = 'block';
                newSection.style.display = 'none';
                commonFields.style.display = 'block';
            } else if (value === 'new') {
                existingSection.style.display = 'none';
                newSection.style.display = 'block';
                commonFields.style.display = 'block';
            } else {
                existingSection.style.display = 'none';
                newSection.style.display = 'none';
                commonFields.style.display = 'none';
            }
            
            // Reset required attributes
            document.getElementById('existingClub').required = (value === 'update' || value === 'remove');
            document.getElementById('newClubName').required = (value === 'new');
            document.getElementById('meetingDetails').required = (value === 'new');
            document.getElementById('location').required = (value === 'new');
        });

        // Handle form submission
        form.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Hide alerts
            successAlert.style.display = 'none';
            errorAlert.style.display = 'none';
            
            // Validate honeypot (anti-spam)
            if (document.getElementById('website').value) {
                console.log('Bot detected');
                return;
            }
            
            // Validate math challenge
            const mathAnswer = parseInt(document.getElementById('mathChallenge').value);
            if (mathAnswer !== 8) {
                errorMessage.textContent = 'Please answer the math question correctly (3 + 5 = 8)';
                errorAlert.style.display = 'block';
                return;
            }
            
            // Disable submit button and show loading
            submitBtn.disabled = true;
            submitBtn.innerHTML = 'Submitting... <span class="loading"></span>';
            
            // Collect form data
            const formData = {
                updateType: document.getElementById('updateType').value,
                timestamp: new Date().toLocaleString('en-US', { timeZone: 'America/New_York' }),
                details: document.getElementById('details').value,
                source: document.getElementById('source').value,
                email: document.getElementById('email').value || 'Not provided'
            };
            
            // Add type-specific data
            if (formData.updateType === 'update' || formData.updateType === 'remove') {
                formData.clubName = document.getElementById('existingClub').value;
                
                // Get checked update items
                const checkedItems = Array.from(document.querySelectorAll('input[name="updateItems"]:checked'))
                    .map(cb => cb.value);
                formData.updateItems = checkedItems.length > 0 ? checkedItems.join(', ') : 'Not specified';
            } else if (formData.updateType === 'new') {
                formData.clubName = document.getElementById('newClubName').value;
                formData.meetingDetails = document.getElementById('meetingDetails').value;
                formData.location = document.getElementById('location').value;
            }
            
            try {
                // Send email using EmailJS
                // REPLACE 'YOUR_SERVICE_ID' and 'YOUR_TEMPLATE_ID' with your actual IDs
                await emailjs.send('YOUR_SERVICE_ID', 'YOUR_TEMPLATE_ID', formData);
                
                // Show success message
                successAlert.style.display = 'block';
                form.reset();
                updateType.dispatchEvent(new Event('change'));
                
                // Scroll to top
                window.scrollTo({ top: 0, behavior: 'smooth' });
            } catch (error) {
                console.error('EmailJS error:', error);
                errorMessage.textContent = 'Failed to send update. Please try again or email us directly.';
                errorAlert.style.display = 'block';
            } finally {
                // Re-enable submit button
                submitBtn.disabled = false;
                submitBtn.innerHTML = 'Submit Update';
            }
        });
    </script>
</body>
</html>